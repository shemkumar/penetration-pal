export interface PentestTool {
  id: string;
  name: string;
  description: string;
  category: 'network' | 'web' | 'password' | 'osint' | 'dns' | 'appsec';
  icon: string;
  command: string;
  fields: ToolField[];
}

export interface ToolField {
  name: string;
  label: string;
  type: 'text' | 'number' | 'select' | 'checkbox';
  placeholder?: string;
  options?: { value: string; label: string }[];
  default?: string | number | boolean;
  required?: boolean;
}

export interface ScanResult {
  id: string;
  toolId: string;
  toolName: string;
  target: string;
  command: string;
  output: string;
  timestamp: Date;
  status: 'running' | 'completed' | 'error';
  duration?: number;
}

export const pentestTools: PentestTool[] = [
  {
    id: 'nmap',
    name: 'Nmap',
    description: 'Network exploration and security auditing',
    category: 'network',
    icon: 'üîç',
    command: 'nmap',
    fields: [
      { name: 'target', label: 'Target', type: 'text', placeholder: '192.168.1.1 or domain.com', required: true },
      { name: 'scanType', label: 'Scan Type', type: 'select', options: [
        { value: '-sS', label: 'SYN Scan (Stealth)' },
        { value: '-sT', label: 'TCP Connect Scan' },
        { value: '-sU', label: 'UDP Scan' },
        { value: '-sV', label: 'Version Detection' },
        { value: '-A', label: 'Aggressive Scan' },
      ], default: '-sS' },
      { name: 'ports', label: 'Ports', type: 'text', placeholder: '1-1000 or 22,80,443', default: '1-1000' },
      { name: 'verbose', label: 'Verbose Output', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'sqlmap',
    name: 'SQLMap',
    description: 'Automatic SQL injection and database takeover',
    category: 'web',
    icon: 'üíâ',
    command: 'sqlmap',
    fields: [
      { name: 'url', label: 'Target URL', type: 'text', placeholder: 'http://target.com/page?id=1', required: true },
      { name: 'level', label: 'Test Level', type: 'select', options: [
        { value: '1', label: 'Level 1 (Default)' },
        { value: '2', label: 'Level 2' },
        { value: '3', label: 'Level 3' },
        { value: '4', label: 'Level 4' },
        { value: '5', label: 'Level 5 (Max)' },
      ], default: '1' },
      { name: 'risk', label: 'Risk Level', type: 'select', options: [
        { value: '1', label: 'Risk 1 (Default)' },
        { value: '2', label: 'Risk 2' },
        { value: '3', label: 'Risk 3 (Max)' },
      ], default: '1' },
      { name: 'dbs', label: 'Enumerate Databases', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'nikto',
    name: 'Nikto',
    description: 'Web server vulnerability scanner',
    category: 'web',
    icon: 'üåê',
    command: 'nikto',
    fields: [
      { name: 'host', label: 'Target Host', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'port', label: 'Port', type: 'number', placeholder: '80', default: 80 },
      { name: 'ssl', label: 'Use SSL', type: 'checkbox', default: false },
      { name: 'tuning', label: 'Tuning', type: 'select', options: [
        { value: '0', label: 'File Upload' },
        { value: '1', label: 'Interesting Files' },
        { value: '2', label: 'Misconfiguration' },
        { value: '3', label: 'Information Disclosure' },
        { value: 'x', label: 'All (except DOS)' },
      ], default: 'x' },
    ],
  },
  {
    id: 'dirb',
    name: 'Dirb',
    description: 'Web content scanner and directory brute-forcer',
    category: 'web',
    icon: 'üìÇ',
    command: 'dirb',
    fields: [
      { name: 'url', label: 'Target URL', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'wordlist', label: 'Wordlist', type: 'select', options: [
        { value: '/usr/share/dirb/wordlists/common.txt', label: 'Common' },
        { value: '/usr/share/dirb/wordlists/big.txt', label: 'Big' },
        { value: '/usr/share/dirb/wordlists/small.txt', label: 'Small' },
      ], default: '/usr/share/dirb/wordlists/common.txt' },
      { name: 'extensions', label: 'Extensions', type: 'text', placeholder: 'php,html,txt' },
    ],
  },
  {
    id: 'hydra',
    name: 'Hydra',
    description: 'Fast network logon cracker',
    category: 'password',
    icon: 'üîê',
    command: 'hydra',
    fields: [
      { name: 'target', label: 'Target', type: 'text', placeholder: '192.168.1.1', required: true },
      { name: 'service', label: 'Service', type: 'select', options: [
        { value: 'ssh', label: 'SSH' },
        { value: 'ftp', label: 'FTP' },
        { value: 'http-post-form', label: 'HTTP POST Form' },
        { value: 'mysql', label: 'MySQL' },
        { value: 'rdp', label: 'RDP' },
        { value: 'smb', label: 'SMB' },
      ], default: 'ssh' },
      { name: 'username', label: 'Username/List', type: 'text', placeholder: 'admin or /path/to/users.txt' },
      { name: 'password', label: 'Password/List', type: 'text', placeholder: '/path/to/passwords.txt' },
      { name: 'threads', label: 'Threads', type: 'number', default: 16 },
    ],
  },
  {
    id: 'wpscan',
    name: 'WPScan',
    description: 'WordPress security scanner',
    category: 'web',
    icon: 'üìù',
    command: 'wpscan',
    fields: [
      { name: 'url', label: 'WordPress URL', type: 'text', placeholder: 'http://wordpress-site.com', required: true },
      { name: 'enumerate', label: 'Enumerate', type: 'select', options: [
        { value: 'vp', label: 'Vulnerable Plugins' },
        { value: 'vt', label: 'Vulnerable Themes' },
        { value: 'u', label: 'Users' },
        { value: 'ap', label: 'All Plugins' },
        { value: 'at', label: 'All Themes' },
      ], default: 'vp' },
      { name: 'aggressive', label: 'Aggressive Mode', type: 'checkbox', default: false },
    ],
  },
  {
    id: 'nuclei',
    name: 'Nuclei',
    description: 'Fast and customizable vulnerability scanner',
    category: 'web',
    icon: '‚öõÔ∏è',
    command: 'nuclei',
    fields: [
      { name: 'target', label: 'Target', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'severity', label: 'Severity', type: 'select', options: [
        { value: 'critical', label: 'Critical' },
        { value: 'high', label: 'High' },
        { value: 'medium', label: 'Medium' },
        { value: 'low', label: 'Low' },
        { value: 'info', label: 'Info' },
      ], default: 'high' },
      { name: 'templates', label: 'Templates', type: 'select', options: [
        { value: 'cves', label: 'CVEs' },
        { value: 'vulnerabilities', label: 'Vulnerabilities' },
        { value: 'misconfigurations', label: 'Misconfigurations' },
        { value: 'exposures', label: 'Exposures' },
      ], default: 'vulnerabilities' },
      { name: 'rateLimit', label: 'Rate Limit', type: 'number', default: 150 },
    ],
  },
  {
    id: 'gobuster',
    name: 'Gobuster',
    description: 'Directory/file & DNS busting tool',
    category: 'web',
    icon: 'üëª',
    command: 'gobuster',
    fields: [
      { name: 'url', label: 'Target URL', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'mode', label: 'Mode', type: 'select', options: [
        { value: 'dir', label: 'Directory' },
        { value: 'dns', label: 'DNS' },
        { value: 'vhost', label: 'Virtual Host' },
      ], default: 'dir' },
      { name: 'wordlist', label: 'Wordlist', type: 'text', placeholder: '/usr/share/wordlists/dirb/common.txt', default: '/usr/share/wordlists/dirb/common.txt' },
      { name: 'threads', label: 'Threads', type: 'number', default: 10 },
      { name: 'extensions', label: 'Extensions', type: 'text', placeholder: 'php,html,js' },
    ],
  },
  {
    id: 'subfinder',
    name: 'Subfinder',
    description: 'Subdomain discovery tool',
    category: 'dns',
    icon: 'üîé',
    command: 'subfinder',
    fields: [
      { name: 'domain', label: 'Domain', type: 'text', placeholder: 'example.com', required: true },
      { name: 'recursive', label: 'Recursive', type: 'checkbox', default: false },
      { name: 'silent', label: 'Silent Mode', type: 'checkbox', default: false },
      { name: 'threads', label: 'Threads', type: 'number', default: 10 },
    ],
  },
  {
    id: 'whatweb',
    name: 'WhatWeb',
    description: 'Web technology identification',
    category: 'web',
    icon: 'üî¨',
    command: 'whatweb',
    fields: [
      { name: 'target', label: 'Target', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'aggression', label: 'Aggression Level', type: 'select', options: [
        { value: '1', label: 'Stealthy' },
        { value: '2', label: 'Unused' },
        { value: '3', label: 'Aggressive' },
        { value: '4', label: 'Heavy' },
      ], default: '1' },
      { name: 'verbose', label: 'Verbose', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'masscan',
    name: 'Masscan',
    description: 'Fast TCP port scanner',
    category: 'network',
    icon: '‚ö°',
    command: 'masscan',
    fields: [
      { name: 'target', label: 'Target Range', type: 'text', placeholder: '192.168.1.0/24', required: true },
      { name: 'ports', label: 'Ports', type: 'text', placeholder: '1-65535 or 80,443', default: '1-1000' },
      { name: 'rate', label: 'Packets/sec', type: 'number', default: 1000 },
      { name: 'banners', label: 'Grab Banners', type: 'checkbox', default: false },
    ],
  },
  {
    id: 'ffuf',
    name: 'ffuf',
    description: 'Fast web fuzzer',
    category: 'web',
    icon: 'üéØ',
    command: 'ffuf',
    fields: [
      { name: 'url', label: 'URL with FUZZ', type: 'text', placeholder: 'http://target.com/FUZZ', required: true },
      { name: 'wordlist', label: 'Wordlist', type: 'text', placeholder: '/usr/share/wordlists/common.txt', required: true },
      { name: 'method', label: 'HTTP Method', type: 'select', options: [
        { value: 'GET', label: 'GET' },
        { value: 'POST', label: 'POST' },
        { value: 'PUT', label: 'PUT' },
      ], default: 'GET' },
      { name: 'filterCode', label: 'Filter Status Code', type: 'text', placeholder: '404,403' },
      { name: 'threads', label: 'Threads', type: 'number', default: 40 },
    ],
  },
  {
    id: 'dnsenum',
    name: 'DNSenum',
    description: 'DNS enumeration tool',
    category: 'dns',
    icon: 'üì°',
    command: 'dnsenum',
    fields: [
      { name: 'domain', label: 'Domain', type: 'text', placeholder: 'example.com', required: true },
      { name: 'threads', label: 'Threads', type: 'number', default: 5 },
      { name: 'bruteforce', label: 'Brute Force', type: 'checkbox', default: false },
      { name: 'whois', label: 'Perform Whois', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'theharvester',
    name: 'theHarvester',
    description: 'OSINT tool for emails, subdomains, IPs',
    category: 'osint',
    icon: 'üåæ',
    command: 'theHarvester',
    fields: [
      { name: 'domain', label: 'Domain', type: 'text', placeholder: 'example.com', required: true },
      { name: 'source', label: 'Data Source', type: 'select', options: [
        { value: 'all', label: 'All Sources' },
        { value: 'google', label: 'Google' },
        { value: 'bing', label: 'Bing' },
        { value: 'linkedin', label: 'LinkedIn' },
        { value: 'twitter', label: 'Twitter' },
        { value: 'shodan', label: 'Shodan' },
      ], default: 'all' },
      { name: 'limit', label: 'Results Limit', type: 'number', default: 500 },
    ],
  },
  {
    id: 'amass',
    name: 'Amass',
    description: 'Attack surface mapping and asset discovery',
    category: 'osint',
    icon: 'üó∫Ô∏è',
    command: 'amass',
    fields: [
      { name: 'domain', label: 'Domain', type: 'text', placeholder: 'example.com', required: true },
      { name: 'mode', label: 'Mode', type: 'select', options: [
        { value: 'enum', label: 'Enumeration' },
        { value: 'intel', label: 'Intelligence' },
      ], default: 'enum' },
      { name: 'passive', label: 'Passive Only', type: 'checkbox', default: true },
      { name: 'timeout', label: 'Timeout (min)', type: 'number', default: 30 },
    ],
  },
  // ========== Advanced Application Security Scanner ==========
  {
    id: 'ssti-detector',
    name: 'SSTI Detection Engineer',
    description: 'Server-Side Template Injection vulnerability scanner',
    category: 'appsec',
    icon: 'üß™',
    command: 'ssti-scanner',
    fields: [
      { name: 'url', label: 'Target URL', type: 'text', placeholder: 'http://target.com/page?param=value', required: true },
      { name: 'method', label: 'HTTP Method', type: 'select', options: [
        { value: 'GET', label: 'GET' },
        { value: 'POST', label: 'POST' },
      ], default: 'GET' },
      { name: 'parameter', label: 'Parameter to Test', type: 'text', placeholder: 'name, id, template', required: true },
      { name: 'engine', label: 'Template Engine', type: 'select', options: [
        { value: 'auto', label: 'Auto-Detect' },
        { value: 'jinja2', label: 'Jinja2 (Python)' },
        { value: 'twig', label: 'Twig (PHP)' },
        { value: 'freemarker', label: 'FreeMarker (Java)' },
        { value: 'velocity', label: 'Velocity (Java)' },
        { value: 'smarty', label: 'Smarty (PHP)' },
      ], default: 'auto' },
      { name: 'aggressive', label: 'Aggressive Mode', type: 'checkbox', default: false },
    ],
  },
  {
    id: 's3-scanner',
    name: 'AWS S3 Bucket Scanner',
    description: 'AWS S3 bucket misconfiguration and exposure scanner',
    category: 'appsec',
    icon: '‚òÅÔ∏è',
    command: 's3scanner',
    fields: [
      { name: 'target', label: 'Bucket/Domain', type: 'text', placeholder: 'bucket-name or domain.com', required: true },
      { name: 'mode', label: 'Scan Mode', type: 'select', options: [
        { value: 'enum', label: 'Enumerate Buckets' },
        { value: 'dump', label: 'Dump Contents' },
        { value: 'permissions', label: 'Check Permissions' },
      ], default: 'enum' },
      { name: 'wordlist', label: 'Wordlist', type: 'select', options: [
        { value: 'common', label: 'Common Names' },
        { value: 'extended', label: 'Extended List' },
        { value: 'custom', label: 'Custom' },
      ], default: 'common' },
      { name: 'checkAcl', label: 'Check ACL', type: 'checkbox', default: true },
      { name: 'checkPolicy', label: 'Check Bucket Policy', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'graphql-scanner',
    name: 'GraphQL Security Scanner',
    description: 'GraphQL endpoint security and introspection analyzer',
    category: 'appsec',
    icon: '‚óà',
    command: 'graphql-scanner',
    fields: [
      { name: 'endpoint', label: 'GraphQL Endpoint', type: 'text', placeholder: 'http://target.com/graphql', required: true },
      { name: 'introspection', label: 'Test Introspection', type: 'checkbox', default: true },
      { name: 'injection', label: 'Test Injections', type: 'checkbox', default: true },
      { name: 'dos', label: 'Test DoS Vectors', type: 'select', options: [
        { value: 'none', label: 'None' },
        { value: 'batching', label: 'Query Batching' },
        { value: 'depth', label: 'Deep Nesting' },
        { value: 'all', label: 'All DoS Tests' },
      ], default: 'batching' },
      { name: 'authHeader', label: 'Auth Header', type: 'text', placeholder: 'Bearer token...' },
    ],
  },
  {
    id: 'api-analyzer',
    name: 'API Security Analyzer',
    description: 'API endpoint discovery and security assessment',
    category: 'appsec',
    icon: 'üîå',
    command: 'api-analyzer',
    fields: [
      { name: 'target', label: 'Target Base URL', type: 'text', placeholder: 'http://api.target.com', required: true },
      { name: 'mode', label: 'Analysis Mode', type: 'select', options: [
        { value: 'discovery', label: 'Endpoint Discovery' },
        { value: 'security', label: 'Security Analysis' },
        { value: 'full', label: 'Full Assessment' },
      ], default: 'full' },
      { name: 'spec', label: 'API Spec URL', type: 'text', placeholder: '/swagger.json or /openapi.yaml' },
      { name: 'authTest', label: 'Test Authentication', type: 'checkbox', default: true },
      { name: 'rateLimit', label: 'Test Rate Limiting', type: 'checkbox', default: true },
      { name: 'injection', label: 'Test Injections', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'waf-bypass',
    name: 'WAF Detection & Bypass',
    description: 'Web Application Firewall detection and bypass testing',
    category: 'appsec',
    icon: 'üõ°Ô∏è',
    command: 'wafw00f',
    fields: [
      { name: 'target', label: 'Target URL', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'mode', label: 'Mode', type: 'select', options: [
        { value: 'detect', label: 'Detection Only' },
        { value: 'bypass', label: 'Bypass Testing' },
        { value: 'fingerprint', label: 'Full Fingerprint' },
      ], default: 'detect' },
      { name: 'payloads', label: 'Payload Set', type: 'select', options: [
        { value: 'xss', label: 'XSS Payloads' },
        { value: 'sqli', label: 'SQLi Payloads' },
        { value: 'rce', label: 'RCE Payloads' },
        { value: 'all', label: 'All Payloads' },
      ], default: 'all' },
      { name: 'verbose', label: 'Verbose Output', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'subdomain-takeover',
    name: 'Subdomain Takeover Detector',
    description: 'Detect vulnerable subdomains susceptible to takeover',
    category: 'appsec',
    icon: 'üéØ',
    command: 'subjack',
    fields: [
      { name: 'domain', label: 'Target Domain', type: 'text', placeholder: 'example.com', required: true },
      { name: 'wordlist', label: 'Subdomain List', type: 'select', options: [
        { value: 'auto', label: 'Auto-Discover' },
        { value: 'common', label: 'Common Subdomains' },
        { value: 'large', label: 'Large Wordlist' },
      ], default: 'auto' },
      { name: 'services', label: 'Check Services', type: 'select', options: [
        { value: 'all', label: 'All Services' },
        { value: 'aws', label: 'AWS Only' },
        { value: 'azure', label: 'Azure Only' },
        { value: 'github', label: 'GitHub Pages' },
      ], default: 'all' },
      { name: 'threads', label: 'Threads', type: 'number', default: 20 },
      { name: 'ssl', label: 'Check SSL', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'js-analyzer',
    name: 'JavaScript File Analyzer',
    description: 'Analyze JS files for secrets, endpoints, and vulnerabilities',
    category: 'appsec',
    icon: 'üìú',
    command: 'linkfinder',
    fields: [
      { name: 'target', label: 'Target URL/Domain', type: 'text', placeholder: 'http://target.com', required: true },
      { name: 'mode', label: 'Analysis Mode', type: 'select', options: [
        { value: 'endpoints', label: 'Find Endpoints' },
        { value: 'secrets', label: 'Find Secrets' },
        { value: 'full', label: 'Full Analysis' },
      ], default: 'full' },
      { name: 'depth', label: 'Crawl Depth', type: 'number', default: 2 },
      { name: 'regex', label: 'Custom Regex', type: 'text', placeholder: 'api|secret|key' },
      { name: 'minify', label: 'Handle Minified', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'cors-scanner',
    name: 'CORS Misconfiguration Scanner',
    description: 'Test for CORS policy misconfigurations',
    category: 'appsec',
    icon: 'üåç',
    command: 'cors-scanner',
    fields: [
      { name: 'target', label: 'Target URL', type: 'text', placeholder: 'http://target.com/api', required: true },
      { name: 'origin', label: 'Test Origin', type: 'text', placeholder: 'https://evil.com', default: 'https://evil.com' },
      { name: 'testNull', label: 'Test Null Origin', type: 'checkbox', default: true },
      { name: 'testWildcard', label: 'Test Wildcard', type: 'checkbox', default: true },
      { name: 'testSubdomain', label: 'Test Subdomain', type: 'checkbox', default: true },
      { name: 'methods', label: 'Test Methods', type: 'select', options: [
        { value: 'GET', label: 'GET Only' },
        { value: 'POST', label: 'POST Only' },
        { value: 'all', label: 'All Methods' },
      ], default: 'all' },
    ],
  },
  {
    id: 'oauth-jwt-analyzer',
    name: 'OAuth/JWT Security Analyzer',
    description: 'Analyze OAuth flows and JWT token security',
    category: 'appsec',
    icon: 'üîë',
    command: 'jwt-tool',
    fields: [
      { name: 'target', label: 'Target/Token', type: 'text', placeholder: 'URL or JWT token', required: true },
      { name: 'mode', label: 'Analysis Mode', type: 'select', options: [
        { value: 'decode', label: 'Decode Token' },
        { value: 'crack', label: 'Crack Secret' },
        { value: 'tamper', label: 'Tamper Testing' },
        { value: 'oauth', label: 'OAuth Flow Analysis' },
      ], default: 'decode' },
      { name: 'wordlist', label: 'Secret Wordlist', type: 'text', placeholder: '/path/to/wordlist.txt' },
      { name: 'testAlgNone', label: 'Test alg:none', type: 'checkbox', default: true },
      { name: 'testKeyConf', label: 'Test Key Confusion', type: 'checkbox', default: true },
    ],
  },
  {
    id: 'osint-module',
    name: 'OSINT Integration Module',
    description: 'Comprehensive OSINT data gathering and analysis',
    category: 'appsec',
    icon: 'üïµÔ∏è',
    command: 'osint-framework',
    fields: [
      { name: 'target', label: 'Target (Domain/Email/Username)', type: 'text', placeholder: 'target.com or user@email.com', required: true },
      { name: 'type', label: 'Target Type', type: 'select', options: [
        { value: 'domain', label: 'Domain' },
        { value: 'email', label: 'Email' },
        { value: 'username', label: 'Username' },
        { value: 'phone', label: 'Phone Number' },
      ], default: 'domain' },
      { name: 'sources', label: 'Data Sources', type: 'select', options: [
        { value: 'all', label: 'All Sources' },
        { value: 'social', label: 'Social Media' },
        { value: 'breaches', label: 'Data Breaches' },
        { value: 'dns', label: 'DNS Records' },
      ], default: 'all' },
      { name: 'deep', label: 'Deep Analysis', type: 'checkbox', default: false },
      { name: 'export', label: 'Export Format', type: 'select', options: [
        { value: 'json', label: 'JSON' },
        { value: 'csv', label: 'CSV' },
        { value: 'html', label: 'HTML Report' },
      ], default: 'json' },
    ],
  },
];

export const categoryLabels: Record<string, string> = {
  network: 'Network Scanning',
  web: 'Web Application',
  password: 'Password Attacks',
  osint: 'OSINT & Recon',
  dns: 'DNS Enumeration',
  appsec: 'Advanced Application Security Scanner',
};

export const categoryColors: Record<string, string> = {
  network: 'text-cyber-blue',
  web: 'text-primary',
  password: 'text-destructive',
  osint: 'text-warning',
  dns: 'text-accent',
  appsec: 'text-cyber-green',
};

export function buildCommand(tool: PentestTool, values: Record<string, any>): string {
  let cmd = tool.command;
  
  switch (tool.id) {
    case 'nmap':
      cmd += ` ${values.scanType || '-sS'}`;
      if (values.ports) cmd += ` -p ${values.ports}`;
      if (values.verbose) cmd += ' -v';
      cmd += ` ${values.target}`;
      break;
    case 'sqlmap':
      cmd += ` -u "${values.url}"`;
      cmd += ` --level=${values.level || 1}`;
      cmd += ` --risk=${values.risk || 1}`;
      if (values.dbs) cmd += ' --dbs';
      break;
    case 'nikto':
      cmd += ` -h ${values.host}`;
      if (values.port) cmd += ` -p ${values.port}`;
      if (values.ssl) cmd += ' -ssl';
      cmd += ` -Tuning ${values.tuning || 'x'}`;
      break;
    case 'dirb':
      cmd += ` ${values.url} ${values.wordlist}`;
      if (values.extensions) cmd += ` -X .${values.extensions.replace(/,/g, ',.')}`;
      break;
    case 'hydra':
      if (values.username?.startsWith('/')) {
        cmd += ` -L ${values.username}`;
      } else if (values.username) {
        cmd += ` -l ${values.username}`;
      }
      if (values.password) cmd += ` -P ${values.password}`;
      cmd += ` -t ${values.threads || 16}`;
      cmd += ` ${values.target} ${values.service}`;
      break;
    case 'wpscan':
      cmd += ` --url ${values.url}`;
      cmd += ` -e ${values.enumerate || 'vp'}`;
      if (values.aggressive) cmd += ' --plugins-detection aggressive';
      break;
    case 'nuclei':
      cmd += ` -u ${values.target}`;
      cmd += ` -severity ${values.severity || 'high'}`;
      cmd += ` -t ${values.templates || 'vulnerabilities'}`;
      cmd += ` -rl ${values.rateLimit || 150}`;
      break;
    case 'gobuster':
      cmd += ` ${values.mode || 'dir'}`;
      cmd += ` -u ${values.url}`;
      cmd += ` -w ${values.wordlist}`;
      cmd += ` -t ${values.threads || 10}`;
      if (values.extensions && values.mode === 'dir') cmd += ` -x ${values.extensions}`;
      break;
    case 'subfinder':
      cmd += ` -d ${values.domain}`;
      if (values.recursive) cmd += ' -recursive';
      if (values.silent) cmd += ' -silent';
      cmd += ` -t ${values.threads || 10}`;
      break;
    case 'whatweb':
      cmd += ` -a ${values.aggression || 1}`;
      if (values.verbose) cmd += ' -v';
      cmd += ` ${values.target}`;
      break;
    case 'masscan':
      cmd += ` ${values.target}`;
      cmd += ` -p${values.ports || '1-1000'}`;
      cmd += ` --rate=${values.rate || 1000}`;
      if (values.banners) cmd += ' --banners';
      break;
    case 'ffuf':
      cmd += ` -u ${values.url}`;
      cmd += ` -w ${values.wordlist}`;
      cmd += ` -X ${values.method || 'GET'}`;
      if (values.filterCode) cmd += ` -fc ${values.filterCode}`;
      cmd += ` -t ${values.threads || 40}`;
      break;
    case 'dnsenum':
      cmd += ` ${values.domain}`;
      cmd += ` --threads ${values.threads || 5}`;
      if (values.bruteforce) cmd += ' -f /usr/share/dnsenum/dns.txt';
      if (!values.whois) cmd += ' --noreverse';
      break;
    case 'theharvester':
      cmd += ` -d ${values.domain}`;
      cmd += ` -b ${values.source || 'all'}`;
      cmd += ` -l ${values.limit || 500}`;
      break;
    case 'amass':
      cmd += ` ${values.mode || 'enum'}`;
      cmd += ` -d ${values.domain}`;
      if (values.passive) cmd += ' -passive';
      cmd += ` -timeout ${values.timeout || 30}`;
      break;
    // Advanced Application Security Scanner tools
    case 'ssti-detector':
      cmd += ` -u "${values.url}"`;
      cmd += ` -m ${values.method || 'GET'}`;
      cmd += ` -p ${values.parameter}`;
      if (values.engine !== 'auto') cmd += ` --engine ${values.engine}`;
      if (values.aggressive) cmd += ' --aggressive';
      break;
    case 's3-scanner':
      cmd += ` --target ${values.target}`;
      cmd += ` --mode ${values.mode || 'enum'}`;
      cmd += ` --wordlist ${values.wordlist || 'common'}`;
      if (values.checkAcl) cmd += ' --check-acl';
      if (values.checkPolicy) cmd += ' --check-policy';
      break;
    case 'graphql-scanner':
      cmd += ` -e ${values.endpoint}`;
      if (values.introspection) cmd += ' --introspection';
      if (values.injection) cmd += ' --test-injection';
      if (values.dos !== 'none') cmd += ` --dos ${values.dos}`;
      if (values.authHeader) cmd += ` -H "Authorization: ${values.authHeader}"`;
      break;
    case 'api-analyzer':
      cmd += ` -t ${values.target}`;
      cmd += ` --mode ${values.mode || 'full'}`;
      if (values.spec) cmd += ` --spec ${values.spec}`;
      if (values.authTest) cmd += ' --test-auth';
      if (values.rateLimit) cmd += ' --test-rate-limit';
      if (values.injection) cmd += ' --test-injection';
      break;
    case 'waf-bypass':
      cmd += ` -u ${values.target}`;
      cmd += ` --mode ${values.mode || 'detect'}`;
      if (values.mode === 'bypass') cmd += ` --payloads ${values.payloads || 'all'}`;
      if (values.verbose) cmd += ' -v';
      break;
    case 'subdomain-takeover':
      cmd += ` -d ${values.domain}`;
      cmd += ` -w ${values.wordlist || 'auto'}`;
      cmd += ` --services ${values.services || 'all'}`;
      cmd += ` -t ${values.threads || 20}`;
      if (values.ssl) cmd += ' --ssl';
      break;
    case 'js-analyzer':
      cmd += ` -i ${values.target}`;
      cmd += ` --mode ${values.mode || 'full'}`;
      cmd += ` --depth ${values.depth || 2}`;
      if (values.regex) cmd += ` --regex "${values.regex}"`;
      if (values.minify) cmd += ' --handle-minified';
      break;
    case 'cors-scanner':
      cmd += ` -u ${values.target}`;
      cmd += ` -o ${values.origin || 'https://evil.com'}`;
      if (values.testNull) cmd += ' --test-null';
      if (values.testWildcard) cmd += ' --test-wildcard';
      if (values.testSubdomain) cmd += ' --test-subdomain';
      cmd += ` --methods ${values.methods || 'all'}`;
      break;
    case 'oauth-jwt-analyzer':
      cmd += ` "${values.target}"`;
      cmd += ` --mode ${values.mode || 'decode'}`;
      if (values.wordlist && values.mode === 'crack') cmd += ` -w ${values.wordlist}`;
      if (values.testAlgNone) cmd += ' --test-alg-none';
      if (values.testKeyConf) cmd += ' --test-key-confusion';
      break;
    case 'osint-module':
      cmd += ` -t "${values.target}"`;
      cmd += ` --type ${values.type || 'domain'}`;
      cmd += ` --sources ${values.sources || 'all'}`;
      if (values.deep) cmd += ' --deep';
      cmd += ` --export ${values.export || 'json'}`;
      break;
    default:
      cmd += ` ${values.target || ''}`;
  }
  
  return cmd;
}